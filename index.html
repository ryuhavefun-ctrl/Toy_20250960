<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>캠퍼스 머니 플래너</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #f5f5f7;
      padding: 20px;
    }

    .app {
      max-width: 960px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.06);
    }

    header {
      margin-bottom: 24px;
    }

    header h1 {
      font-size: 1.8rem;
      margin-bottom: 6px;
    }

    header p {
      color: #555;
      font-size: 0.95rem;
    }

    .layout {
      display: grid;
      grid-template-columns: 1.1fr 1.4fr;
      gap: 24px;
    }

    @media (max-width: 768px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    h2 {
      font-size: 1.1rem;
      margin-bottom: 10px;
    }

    .card {
      background: #fafafa;
      border-radius: 12px;
      padding: 16px;
      border: 1px solid #e5e5e5;
    }

    .form-group {
      margin-bottom: 12px;
    }

    label {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 4px;
      color: #333;
    }

    input, select, button {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #d0d0d0;
      font-size: 0.9rem;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #007aff;
      box-shadow: 0 0 0 2px rgba(0,122,255,0.15);
    }

    button {
      cursor: pointer;
      border: none;
      background: #007aff;
      color: white;
      font-weight: 600;
      margin-top: 4px;
    }

    button:hover {
      opacity: 0.9;
    }

    .filter-section {
      margin: 16px 0;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .filter-btn {
      flex: 1;
      min-width: 80px;
      padding: 6px 10px;
      font-size: 0.8rem;
      background: #e9e9ec;
      color: #333;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      text-align: center;
    }

    .filter-btn.active {
      background: #007aff;
      color: #fff;
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 16px;
    }

    .summary-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 12px;
      border: 1px solid #e5e5e5;
    }

    .summary-card p.label {
      font-size: 0.8rem;
      color: #777;
      margin-bottom: 4px;
    }

    .summary-card p.value {
      font-size: 1.1rem;
      font-weight: 600;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }

    thead {
      background: #f2f2f2;
    }

    th, td {
      padding: 8px;
      border-bottom: 1px solid #eee;
      text-align: center;
    }

    th {
      font-weight: 600;
      color: #555;
    }

    tbody tr:hover {
      background: #fafafa;
    }

    .delete-btn {
      background: #ff3b30;
      color: #fff;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.75rem;
    }

    .delete-btn:hover {
      opacity: 0.9;
    }

    .no-data {
      text-align: center;
      color: #888;
      padding: 12px 0;
      font-size: 0.85rem;
    }

    .desc {
      font-size: 0.8rem;
      color: #777;
      margin-top: 6px;
      line-height: 1.3;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>캠퍼스 머니 플래너</h1>
      <p>대학생을 위한 간단 소비 관리 웹앱입니다. 오늘 쓴 돈을 기록하고, 한 달 소비 패턴을 확인해 보세요.</p>
    </header>

    <div class="layout">
      <!-- 입력 영역 -->
      <section>
        <h2>지출 입력</h2>
        <div class="card">
          <form id="expense-form">
            <div class="form-group">
              <label for="date">날짜</label>
              <input type="date" id="date" required>
            </div>
            <div class="form-group">
              <label for="title">항목</label>
              <input type="text" id="title" placeholder="예: 점심, 택시, 카페" required>
            </div>
            <div class="form-group">
              <label for="category">카테고리</label>
              <select id="category" required>
                <option value="">선택하세요</option>
                <option value="식비">식비</option>
                <option value="교통">교통</option>
                <option value="쇼핑">쇼핑</option>
                <option value="자기계발">자기계발</option>
                <option value="기타">기타</option>
              </select>
            </div>
            <div class="form-group">
              <label for="amount">금액 (원)</label>
              <input type="number" id="amount" min="0" step="100" placeholder="예: 8000" required>
            </div>
            <button type="submit">지출 추가하기</button>
            <p class="desc">
              * 입력한 내역은 브라우저에만 저장됩니다(localStorage 사용).<br>
              * 새로고침해도 데이터가 유지되며, 다른 기기에서는 보이지 않습니다.
            </p>
          </form>
        </div>
      </section>

      <!-- 요약 + 리스트 영역 -->
      <section>
        <h2>지출 현황</h2>

        <!-- 필터 버튼 -->
        <div class="filter-section">
          <button class="filter-btn active" data-category="전체">전체</button>
          <button class="filter-btn" data-category="식비">식비</button>
          <button class="filter-btn" data-category="교통">교통</button>
          <button class="filter-btn" data-category="쇼핑">쇼핑</button>
          <button class="filter-btn" data-category="자기계발">자기계발</button>
          <button class="filter-btn" data-category="기타">기타</button>
        </div>

        <!-- 요약 정보 -->
        <div class="summary-grid">
          <div class="summary-card">
            <p class="label">총 지출 금액</p>
            <p class="value"><span id="total-amount">0</span> 원</p>
          </div>
          <div class="summary-card">
            <p class="label">지출 건수</p>
            <p class="value"><span id="total-count">0</span> 건</p>
          </div>
        </div>

        <!-- 리스트 -->
        <div class="card">
          <table>
            <thead>
              <tr>
                <th>날짜</th>
                <th>항목</th>
                <th>카테고리</th>
                <th>금액</th>
                <th>삭제</th>
              </tr>
            </thead>
            <tbody id="expense-table-body">
              <!-- 데이터가 없을 때 메시지 표시 -->
            </tbody>
          </table>
          <div id="no-data" class="no-data">아직 입력된 지출 내역이 없습니다.</div>
        </div>
      </section>
    </div>
  </div>

  <script>
    // 지출 데이터 배열
    let expenses = [];

    // DOM 요소 가져오기
    const expenseForm = document.getElementById('expense-form');
    const expenseTableBody = document.getElementById('expense-table-body');
    const totalAmountEl = document.getElementById('total-amount');
    const totalCountEl = document.getElementById('total-count');
    const noDataEl = document.getElementById('no-data');
    const filterButtons = document.querySelectorAll('.filter-btn');

    let currentFilter = '전체';

    // localStorage에서 데이터 불러오기
    function loadExpenses() {
      const saved = localStorage.getItem('campus_expenses');
      if (saved) {
        expenses = JSON.parse(saved);
      } else {
        expenses = [];
      }
      render();
    }

    // localStorage에 저장
    function saveExpenses() {
      localStorage.setItem('campus_expenses', JSON.stringify(expenses));
    }

    // 폼 제출 이벤트
    expenseForm.addEventListener('submit', function(e) {
      e.preventDefault();

      const date = document.getElementById('date').value;
      const title = document.getElementById('title').value.trim();
      const category = document.getElementById('category').value;
      const amountValue = document.getElementById('amount').value;

      if (!date || !title || !category || !amountValue) {
        alert('모든 내용을 입력해주세요.');
        return;
      }

      const amount = Number(amountValue);
      if (amount <= 0) {
        alert('금액은 0원보다 커야 합니다.');
        return;
      }

      const newExpense = {
        id: Date.now(),  // 고유 ID
        date,
        title,
        category,
        amount
      };

      expenses.push(newExpense);
      saveExpenses();
      render();

      // 입력값 초기화
      expenseForm.reset();
    });

    // 삭제 기능
    function deleteExpense(id) {
      expenses = expenses.filter(exp => exp.id !== id);
      saveExpenses();
      render();
    }

    // 필터 버튼 이벤트
    filterButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        filterButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.getAttribute('data-category');
        render();
      });
    });

    // 화면 렌더링
    function render() {
      // 현재 필터에 맞는 데이터만 필터링
      let filtered = expenses;
      if (currentFilter !== '전체') {
        filtered = expenses.filter(exp => exp.category === currentFilter);
      }

      // 테이블 비우기
      expenseTableBody.innerHTML = '';

      if (filtered.length === 0) {
        noDataEl.style.display = 'block';
      } else {
        noDataEl.style.display = 'none';
        filtered.forEach(exp => {
          const tr = document.createElement('tr');

          const tdDate = document.createElement('td');
          tdDate.textContent = exp.date;

          const tdTitle = document.createElement('td');
          tdTitle.textContent = exp.title;

          const tdCategory = document.createElement('td');
          tdCategory.textContent = exp.category;

          const tdAmount = document.createElement('td');
          tdAmount.textContent = exp.amount.toLocaleString() + '원';

          const tdDelete = document.createElement('td');
          const delBtn = document.createElement('button');
          delBtn.textContent = '삭제';
          delBtn.className = 'delete-btn';
          delBtn.addEventListener('click', () => deleteExpense(exp.id));
          tdDelete.appendChild(delBtn);

          tr.appendChild(tdDate);
          tr.appendChild(tdTitle);
          tr.appendChild(tdCategory);
          tr.appendChild(tdAmount);
          tr.appendChild(tdDelete);

          expenseTableBody.appendChild(tr);
        });
      }

      // 요약 정보 업데이트
      const totalAmount = filtered.reduce((sum, exp) => sum + exp.amount, 0);
      const totalCount = filtered.length;

      totalAmountEl.textContent = totalAmount.toLocaleString();
      totalCountEl.textContent = totalCount;
    }

    // 초기 실행
    document.addEventListener('DOMContentLoaded', loadExpenses);
  </script>
</body>
</html>
